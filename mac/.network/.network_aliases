export TCPDUMP_DIR="$HOME/.tcpdump"

whereami() {
    local target_ip="${1:-$(curl -4s https://ifconfig.co)}"
    curl -s "https://ipinfo.io/${target_ip}/json" | jq "{ip, city, region, country, org, loc, timezone}"
}

ssh_dump() {
    local interface="${1:-any}"
    local dumps_filename="${2:-ssh_dump.pcap}"
    local outfile_path="$TCPDUMP_DIR/$dumps_filename"

    mkdir -p "$TCPDUMP_DIR"

    sudo tcpdump -i "$interface" -w "$outfile_path" -v '(tcp port 22 or tcp port 2222) and tcp[tcpflags] & tcp-syn != 0'
}
