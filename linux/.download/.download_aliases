# downloader options
export DOWNLOADS_DB_PATH="$HOME/scripts/downloads.db"
export DOWNLOADS_DIRECTORY="/srv/shared"
export DOWNLOADS_FILENAME="downloads.txt"
export DOWNLOADER_TYPE="ytdlp_video"
export DOWNLOADER_KEYS="downloader_type,downloader_path"
export DOWNLOAD_KEYS="url,downloader,download_status"

download() {
    run_venv_script "downloader.py" download "$@"
}

downloaders() {
    run_venv_script "downloader.py" downloaders -t "" "$@"
}

download_all() {
    downloads_path="$1"

    if [ $# -gt 1 ]; then
        shift # Remove the downloads path
        extra_args=("$@")
    else
        extra_args=()
    fi

    if [ ! -f "$downloads_path" ]; then
        echo "Downloads path $downloads_path not found."
        echo "Usage: download_all <downloads_path.txt>"
        return 1
    fi

    while IFS= read -r line; do
        if [[ -n "$line" ]]; then
            cmd=$(printf '%q ' "${extra_args[@]}")
            run_in_tmux_session "source $HOME/.zshrc; download \"${line}\" "$cmd""
        fi
    done <"$downloads_path"

}
