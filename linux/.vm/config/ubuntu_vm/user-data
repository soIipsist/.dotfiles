#cloud-config
hostname: ubuntu_vm
fqdn: ubuntu_vm.local

users:
  - name: ubuntu
    sudo: ALL=(ALL) NOPASSWD:ALL
    passwd: ubuntu123
    lock_passwd: false
    shell: /bin/bash
    ssh-authorized-keys:
      - $SSH_KEY

chpasswd:
  expire: false

ssh_pwauth: false

package_update: true
package_upgrade: true

packages:
  - transmission-cli
  - transmission-daemon
  - net-tools
  - iproute2
  - wget
  - curl
  - vim
  - less
  - file
  - openssh-server
  - git

# Ensure network is up before running commands
bootcmd:
  - [cloud-init-per, once, update-system, apt-get, update]
  - [cloud-init-per, once, upgrade-system, apt-get, "-y", upgrade]

runcmd:
  - git clone https://github.com/soIipsist/.dotfiles.git
  - chown -R ubuntu:ubuntu ~/.dotfiles
  - |
    cd /home/ubuntu/.dotfiles
    bash setup.sh .network .ufw .download
